<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Vitra – Herbal Medicine AI Hub</title>

  <!-- Montserrat & FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* RESET & VARIABLES */
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Montserrat',sans-serif; }
    :root {
      --accent:#8ECDF1; --bg1:#161B22; --bg2:#1E2126;
      --text:#E0E0E0; --muted:rgba(224,224,224,0.6); --radius:8px;
    }
    :root.light { --bg1:#F4F4F4; --bg2:#FFF; --text:#111; --muted:rgba(0,0,0,0.4); }
    html,body{height:100%;background:var(--bg1);color:var(--text);}
    a{color:inherit;text-decoration:none;} button,input,select,textarea{font:inherit;color:inherit;}
    button{cursor:pointer;background:none;border:none;}

    /* LAYOUT */
    body{display:flex;overflow:hidden;}
    #sidebar{width:240px;background:var(--bg1);display:flex;flex-direction:column;transition:width .3s;}
    #sidebar.collapsed{width:60px;}
    .brand{padding:1.5rem;font-weight:700;color:var(--accent);}
    .nav-links a{display:flex;align-items:center;gap:.75rem;padding:.9rem 1.2rem;transition:bg .2s;}
    .nav-links a.active,.nav-links a:hover{background:var(--accent)20;}
    .nav-links i{width:24px;text-align:center;color:var(--accent);}
    .toggle-sidebar{padding:1rem;text-align:center;border-top:1px solid #29303A;cursor:pointer;}

    #main{flex:1;display:flex;flex-direction:column;}
    header{display:flex;justify-content:space-between;align-items:center;
      padding:1rem 2rem;background:var(--bg1)CC;backdrop-filter:blur(6px);
      position:sticky;top:0;z-index:10;
    }
    #toggleSidebarBtn{font-size:1.4rem;cursor:pointer;}
    .greeting h1{font-size:1.8rem;display:flex;align-items:center;gap:.5rem;}
    .greeting p{opacity:.75;}
    .header-right i{margin-left:1rem;font-size:1.3rem;cursor:pointer;transition:transform .2s;}
    .header-right i:hover{transform:scale(1.2);}
    .content{flex:1;overflow-y:auto;padding:1rem 2rem;}

    /* STATS CARDS */
    .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin-bottom:1.5rem;}
    .stat-card{background:var(--bg2);border-radius:var(--radius);padding:1rem;display:flex;align-items:center;gap:1rem;transition:transform .2s,box-shadow .2s;}
    .stat-card:hover{transform:translateY(-4px);box-shadow:0 4px 12px rgba(0,0,0,0.5);}
    .stat-card i{font-size:1.6rem;color:var(--accent);}
    .stat-card .details h3{font-size:1rem;margin-bottom:.3rem;}
    .stat-card .details p{opacity:.8;color:var(--accent);}

    /* MODULES */
    section.module{background:var(--bg2);border-radius:var(--radius);padding:1rem;margin-bottom:1.5rem;transition:box-shadow .2s;}
    section.module:hover{box-shadow:0 4px 12px rgba(0,0,0,0.5);}
    section.module h2{display:flex;align-items:center;gap:.5rem;font-size:1.1rem;margin-bottom:.75rem;}
    section.module p.small{font-size:.85rem;color:var(--muted);margin-bottom:.5rem;}
    section.module form{display:flex;flex-direction:column;gap:.5rem;}
    section.module label{font-size:.9rem;}
    section.module input,section.module select,section.module textarea{
      width:100%;background:var(--bg1);border:1px solid #29303A;padding:.5rem;border-radius:var(--radius);transition:border-color .2s;
    }
    section.module input:focus,select:focus,textarea:focus{border-color:var(--accent);outline:none;}
    section.module button{background:var(--accent);color:var(--bg1);padding:.5rem 1rem;border-radius:var(--radius);transition:background .2s;align-self:flex-start;}
    section.module button:hover{background:var(--accent)CC;}

    /* CHARTS */
    .chart-box{background:var(--bg2);border-radius:var(--radius);padding:1rem;margin-bottom:1.5rem;}
    .chart-box canvas{width:100%!important;height:180px!important;}
  </style>
</head>
<body>

  <!-- SIDEBAR -->
  <aside id="sidebar">
    <div class="brand"><i class="fas fa-medkit"></i>Vitra</div>
    <nav class="nav-links">
      <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
      <a href="herbs.html" class="active"><i class="fas fa-seedling"></i><span>Herbal AI</span></a>
      <a href="mental.html"><i class="fas fa-brain"></i><span>Mental</span></a>
      <a href="diet.html"><i class="fas fa-utensils"></i><span>Diet</span></a>
      <a href="pharmacy.html"><i class="fas fa-pills"></i><span>E‑Pharmacy</span></a>
      <a href="booking.html"><i class="fas fa-calendar-check"></i><span>Booking</span></a>
      <a href="settings.html"><i class="fas fa-cog"></i><span>Settings</span></a>
    </nav>
    <div class="toggle-sidebar"><i class="fas fa-arrow-circle-left"></i></div>
  </aside>

  <!-- MAIN -->
  <div id="main">
    <header>
      <div class="header-left">
        <i id="toggleSidebarBtn" class="fas fa-bars"></i>
        <div class="greeting">
          <h1><i class="fas fa-seedling"></i> Herbal AI Hub</h1>
          <p>Powerful AI features for herbal medicine</p>
        </div>
      </div>
      <div class="header-right">
        <i class="fas fa-bell"></i>
        <i class="fas fa-user-circle"></i>
        <i id="themeToggle" class="fas fa-moon" title="Toggle theme"></i>
      </div>
    </header>

    <div class="content">
      <!-- STATS -->
      <div class="stats">
        <div class="stat-card"><i class="fas fa-camera"></i><div class="details"><h3>Identifications</h3><p id="stat-id">0</p></div></div>
        <div class="stat-card"><i class="fas fa-flask"></i><div class="details"><h3>Profilings</h3><p id="stat-profiling">0</p></div></div>
        <div class="stat-card"><i class="fas fa-exchange-alt"></i><div class="details"><h3>Interactions</h3><p id="stat-int">0</p></div></div>
        <div class="stat-card"><i class="fas fa-cubes"></i><div class="details"><h3>Blends</h3><p id="stat-blend">0</p></div></div>
        <div class="stat-card"><i class="fas fa-chart-line"></i><div class="details"><h3>Harvest</h3><p id="stat-harvest">0</p></div></div>
        <div class="stat-card"><i class="fas fa-comment-medical"></i><div class="details"><h3>Chats</h3><p id="stat-chat">0</p></div></div>
        <div class="stat-card"><i class="fas fa-chart-bar"></i><div class="details"><h3>Outcomes</h3><p id="stat-outcome">0</p></div></div>
      </div>

      <!-- 1. Herb Identification & Authentication -->
      <section class="module">
        <h2><i class="fas fa-camera"></i> Herb Identification</h2>
        <p class="small">Snap a photo to verify species & purity using AI vision.</p>
        <video id="camera-stream" autoplay style="width:100%;border-radius:var(--radius);background:#000;"></video>
        <button id="snap-btn"><i class="fas fa-camera-retro"></i> Capture & Identify</button>
        <p id="identifyResult" class="small"></p>
      </section>

      <!-- 2. Phytochemical Profiling & Dosage Recommendations -->
      <section class="module">
        <h2><i class="fas fa-flask"></i> Profiling & Dosage</h2>
        <p class="small">ML on assay fingerprints + user metrics for custom dosage.</p>
        <form onsubmit="runProfiling();return false;">
          <label>Age<input type="number" id="age" min="0" required></label>
          <label>Weight (kg)<input type="number" id="weight" min="0" required></label>
          <label>Metabolism<select id="metabolism"><option>Standard</option><option>Fast</option><option>Slow</option></select></label>
          <button type="submit"><i class="fas fa-calculator"></i> Calculate</button>
        </form>
        <p id="profilingResult" class="small"></p>
      </section>

      <!-- 3. Interaction Prediction -->
      <section class="module">
        <h2><i class="fas fa-exchange-alt"></i> Interaction Prediction</h2>
        <p class="small">Forecast herb‑drug & herb‑herb interactions via GNNs.</p>
        <form onsubmit="runInteractionPredict();return false;">
          <label>Herb A<select id="herbA"><option>Ginkgo</option><option>Turmeric</option></select></label>
          <label>Herb B<select id="herbB"><option>Ginkgo</option><option>St. John’s Wort</option></select></label>
          <button type="submit"><i class="fas fa-search"></i> Check</button>
        </form>
        <p id="interactionResult" class="small"></p>
      </section>

      <!-- 4. Smart Formulation & Blend Optimization -->
      <section class="module">
        <h2><i class="fas fa-cubes"></i> Blend Optimization</h2>
        <p class="small">Auto‑mix compounds for max efficacy with RL & evolutionary AI.</p>
        <label>Anti‑Inflammatory<input type="range" id="slider1" value="50"></label>
        <label>Antioxidant<input type="range" id="slider2" value="50"></label>
        <label>Calming<input type="range" id="slider3" value="50"></label>
        <button onclick="runBlendOpt();"><i class="fas fa-magic"></i> Build Blend</button>
        <p id="blendResult" class="small"></p>
      </section>

      <!-- 5. Predictive Harvesting & Quality Forecasting -->
      <div class="chart-box">
        <h2><i class="fas fa-chart-line"></i> Harvest Forecast</h2>
        <p class="small">IoT + time‑series models to pick optimal harvest windows.</p>
        <canvas id="harvestChart"></canvas>
      </div>

      <!-- 6. Virtual Herbalist Chatbot -->
      <section class="module">
        <h2><i class="fas fa-comment-medical"></i> Virtual Herbalist Chatbot</h2>
        <p class="small">Evidence‑based chat, escalate to pharmacist above confidence threshold.</p>
        <div id="chatBox" style="max-height:150px;overflow-y:auto;padding:.5rem;background:var(--bg1);border-radius:var(--radius);"></div>
        <div style="display:flex;gap:.5rem;margin-top:.5rem;">
          <input id="chatInput" placeholder="e.g. ‘Chamomile insomnia’…" style="flex:1;padding:.5rem;border:1px solid #29303A;border-radius:var(--radius);">
          <button id="sendChat"><i class="fas fa-paper-plane"></i></button>
        </div>
      </section>

      <!-- 7. Outcomes Monitoring & Continuous Learning -->
      <div class="chart-box">
        <h2><i class="fas fa-chart-bar"></i> Outcomes Tracking</h2>
        <p class="small">Track symptom relief & feed back into continuous ML improvements.</p>
        <canvas id="outcomeChart"></canvas>
      </div>
    </div>
  </div>

  <script>
    const API_BASE='http://localhost:4000/api';
    function bump(key){const e=document.getElementById('stat-'+key);if(e)e.textContent=+e.textContent+1;}

    // 1. Identification
    navigator.mediaDevices.getUserMedia({video:true})
      .then(s=>document.getElementById('camera-stream').srcObject=s);
    document.getElementById('snap-btn').onclick=()=>{
      bump('id');
      document.getElementById('identifyResult').textContent='Echinacea purpurea (95% pure)';
    };

    // 2. Profiling & Dosage
    function runProfiling(){
      bump('profiling');
      const w=+age.value, g=+weight.value;
      profilingResult.textContent=`Dose: ${Math.round(g*0.5)} mg, profile: ${metabolism.value}`;
    }

    // 3. Interaction
    function runInteractionPredict(){
      bump('int');
      interactionResult.textContent='No major interactions detected.';
    }

    // 4. Blend
    function runBlendOpt(){
      bump('blend');
      blendResult.textContent=`Blend: ${slider1.value}/${slider2.value}/${slider3.value}`;
    }

    // 5. Harvest Chart
    new Chart(harvestChart,{type:'line',data:{labels:['Jan','Mar','May','Jul'],datasets:[{data:[10,30,50,70],borderColor:'var(--accent)',fill:false}]}});
    bump('harvest');

    // 6. Chatbot
    sendChat.onclick=()=>{
      const txt=chatInput.value.trim(); if(!txt)return;
      bump('chat');
      chatBox.innerHTML+=`<p><strong>You:</strong> ${txt}</p>`;
      chatInput.value='';
      chatBox.innerHTML+=`<p><strong>Herbalist:</strong> Chamomile helps mild insomnia.</p>`;
      chatBox.scrollTop=chatBox.scrollHeight;
    };

    // 7. Outcomes Chart
    new Chart(outcomeChart,{type:'bar',data:{labels:['Wk1','Wk2','Wk3','Wk4'],datasets:[{data:[20,40,60,80],backgroundColor:'var(--accent)'}]},
      options:{scales:{y:{beginAtZero:true,max:100}}}});
    bump('outcome');

    // Sidebar & Theme toggles
    toggleSidebarBtn.onclick=()=>sidebar.classList.toggle('collapsed');
    document.querySelector('.toggle-sidebar').onclick=()=>sidebar.classList.toggle('collapsed');
    themeToggle.onclick=()=>{
      document.documentElement.classList.toggle('light');
      themeToggle.classList.toggle('fa-sun');
    };
  </script>
</body>
</html>
